<!DOCTYPE html>
{% extends 'SurfersBible/fixedcontent.html' %}

{% block title %}
		SurferSense - Provide Location
{% endblock %}


{% block content %}
{% load static %}
	<br><br><br>
  <main class="page landing-page">
   <section class="clean-block clean-info dark" style="background-color: rgb(255,255,255);">
    <div class="article-list">
        <div class="container">
            <!-- <div class="intro"> -->
                <!-- <h2 class="text-center">Latest Articles</h2> -->
            <!-- </div> -->
            <div>
                <div class="container-fluid" style="font-family: Montserrat, sans-serif;">
                    <h2 style="color: rgb(37, 93, 144);"><em>Hospitals Near By</em></h2>
                    <form id="contactForm" action="emergency" method="POST">
							{% csrf_token %}
                        <div class="form-row">
                            <div class="col-md-6">
                                <div id="successfail"></div>
                            </div>
                        </div>
                        <div class="form-row justify-content-center">
                            <div class="col-12 col-md-6" id="message">
                                <h2 class="h4" style="color: rgb(37, 93, 144);"><i class="fa fa-map-pin"></i> Current Location</h2>
									<input type="hidden" id="longitude" name="longitude" value="">
									<input type="hidden" id="latitude" name="latitude" value="">
									<button class="btn btn-primary btn-block" id="location button" onclick="getLocation()" type="button"> Allow GPS Location </button>
									<hr class="d-flex d-md-none">
									<script>
									var clicked = false;
									var allowGeoRecall = true;
										function checkfunc(){
											
											if (!clicked){
												var form = document.getElementById("contactForm");
												function handleForm(event) { event.preventDefault(); } 
												form.addEventListener('submit', handleForm);
												<!-- console.log("correct"); -->
												alert("You have not clicked on the Allow GPS Location ");
											}
											else{
												<!-- console.log("inside else") -->
												document.getElementById("contactForm").submit();
											}
											<!-- else if (document.getElementById('text address').value === "") -->
										}
										function getLocation() {
											clicked = true
											if (navigator.geolocation) {
											navigator.geolocation.getCurrentPosition(showPosition, positionError);
											} 
											else { 
											<!-- console.log("Geolocation is not supported by this browser."); -->
											}
										}
										function positionError() {  
											alert("You have not allowed the location access of the site. Please change the setting and realod the page")
											var form = document.getElementById("contactForm");
											function handleForm(event) { event.preventDefault(); } 
											form.addEventListener('submit', handleForm);
										}

										function showPosition(position) {
											
											allowGeoRecall = false;
											document.getElementById('latitude').value =position.coords.latitude;
											document.getElementById('longitude').value =position.coords.longitude;
											document.getElementById('location button').insertAdjacentHTML('beforeend','&#x2714;');
											<!-- console.log(document.getElementById('latitude').value); -->
											<!-- console.log(document.getElementById('longitude').value); -->
											document.getElementById("contactForm").submit();

											<!-- var geo_data = JSON.parse("{{ beaches|escapejs }}"); -->
											<!-- var data = []; -->
											<!-- for (var key in geo_data) { -->
												<!-- if (geo_data.hasOwnProperty(key)) { -->
													<!-- data.push(geo_data[key]); -->
												<!-- } -->
											<!-- } -->
											<!-- console.log(data) -->
										}
									</script>
								<!-- <iframe allowfullscreen="" frameborder="0" src="https://www.google.com/maps/embed/v1/place?key=AIzaSyCpGApqM5paows4rNCIeGGKeJ9o0QieVcc&amp;q=melbourne&amp;zoom=15" width="100%"> --> 
                                    <!-- height="450"></iframe> -->
                                <hr class="d-flex d-md-none">
                            </div>
                            
                        </div>
                    </form>
					
                </div>
                <div class="modal fade" role="dialog" tabindex="-1" id="modal1">
                    <div class="modal-dialog modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h4 class="modal-title">Contact Information</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button></div>
                            <div class="modal-body">
                                <form id="contactForm" action="javascript:void(0);" method="get"><input class="form-control" type="hidden" name="Introduction" value="This email was sent from www.awebsite.com"><input class="form-control" type="hidden" name="subject" value="Awebsite.com Contact Form"><input class="form-control"
                                        type="hidden" name="to" value="email@awebsite.com">
                                    <div class="form-row">
                                        <div class="col-md-6">
                                            <div id="successfail"></div>
                                        </div>
                                    </div>

                                          <div class="form-group">
                                              <div class="form-row">
                                                  <div class="col"><button class="btn btn-primary btn-block" type="reset"><i class="fa fa-undo"></i> Reset</button></div>
                                                  <div class="col"><button class="btn btn-primary btn-block" onclick="checkFunc();" >Submit <i class="fa fa-chevron-circle-right"></i></button></div>
                                              </div>
                                          </div>
                                          <hr class="d-flex d-md-none">
                                      </div>
                                      <div class="col-12 col-md-6">
                                          <h2 class="h4"><i class="fa fa-location-arrow"></i> Currentlocation</h2>
                                          <div class="form-row">
                                              <div class="col-12">
                                                  
                                              </div>
                                  </div>
                              </form>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
            <div></div>
            <div></div>
			
    <main class="page"></main>
	            </div>
        </div>
	        </section>
    </main>
 {% endblock %}
